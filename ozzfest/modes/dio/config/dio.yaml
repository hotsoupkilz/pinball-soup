#config_version=6

# Dio Mode - "Holy Diver"
# Theme: deep blue, underwater/dragon imagery
# Task: Hit 20 switches (kickout holes, playfield_active switches, or drop targets)
# Duration: Until all tasks complete (no timer)
# Progress persists across ball drains

mode:
  start_events: start_mode_dio
  stop_events: dio_complete, ball_will_end
  priority: 150

# Counter to track switch hits - persists across balls
counters:
  dio_progress:
    starting_count: 0
    count_complete_value: 20
    count_events: dio_switch_hit
    events_when_complete: dio_complete
    persist_state: true
    enable_events: mode_dio_started
    disable_events: dio_complete

# Use event_player to count any valid switch hit
event_player:
  # Kickout holes
  s_kickout_hole_upper_active: dio_switch_hit
  s_kickout_hole_lower_active: dio_switch_hit
  # Playfield active switches (rollovers, standups, inlanes, outlanes, etc.)
  s_target_1_active: dio_switch_hit
  s_target_2_active: dio_switch_hit
  s_target_3_active: dio_switch_hit
  s_inlane_rollover_4_active: dio_switch_hit
  s_inlane_rollover_5_active: dio_switch_hit
  s_outlane_left_active: dio_switch_hit
  s_outlane_right_active: dio_switch_hit
  s_turnaround_rollover_lower_active: dio_switch_hit
  s_turnaround_rollover_upper_active: dio_switch_hit
  s_upper_left_standup_active: dio_switch_hit
  s_left_standup_active: dio_switch_hit
  s_right_standup_active: dio_switch_hit
  s_playfield_entry_gate_active: dio_switch_hit
  # Drop targets (3-banks and 5-bank)
  s_threebank_left_lower_active: dio_switch_hit
  s_threebank_left_mid_active: dio_switch_hit
  s_threebank_left_upper_active: dio_switch_hit
  s_threebank_right_lower_active: dio_switch_hit
  s_threebank_right_mid_active: dio_switch_hit
  s_threebank_right_upper_active: dio_switch_hit
  s_fivebank_left_active: dio_switch_hit
  s_fivebank_left_mid_active: dio_switch_hit
  s_fivebank_center_active: dio_switch_hit
  s_fivebank_right_mid_active: dio_switch_hit
  s_fivebank_right_active: dio_switch_hit

variable_player:
  dio_switch_hit:
    score: 5000
  dio_complete:
    score: 100000
    dio_completed:
      int: 1
      action: set
    bands_completed:
      int: 1
      action: add

hardware_sound_player:
  mode_dio_started:
    "dio_holy_diver.snd":
      track: 1
      action: play_file
      platform_options:
        loop: true

# O light flashes 2x/sec during mode, stays on solid when complete
show_player:
  mode_dio_started:
    flash_letter_o:
      key: dio_flash
      speed: 1
      loops: -1
  dio_complete:
    dio_flash: stop
  mode_dio_stopped:
    dio_flash: stop

light_player:
  dio_complete:
    l_letter_o: ff

slide_player:
  mode_dio_started:
    dio_mode:
      priority: 150
  mode_dio_stopped:
    dio_mode:
      action: remove
